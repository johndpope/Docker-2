## Docker-compose skeleton template ##

# This contains a rough outline of the sections I use to build and configure
# docker-compose files for individual applications. The file has a rough
# docker-compose file that contains things that are more or less universal
# in all of my compose files. Things such as Traefik labels and shared values

###################################################
###################################################
##### WhitehomeIO wikijs Docker-Compose File ######
###################################################
###################################################

##################################################
##################################################

# The skeleton's bones
---
version: "3.7"
services:
  $Service:
    image: $image
    container_name: $name
    networks:
      - $network00
      - $network01
    ports:
      - $port:80
    labels:
      - $labels
    environment:
      - $environments
    volumes:
      - $filepath:/config
    restart: unless-stopped

##################################################

  Application: #Application to deploy
    image: linuxserver/ #The image to pull
    container_name: #Name of container ------ Depreciated, but I still keep
    networks: #Docker networks to communicate on
     - traefik-proxy
    ports: #Host/Docker port mappings
      - $APP_PORT:8686 #hostport:containerport
    labels: # Labels assigned to the applications
      - traefik.enable=true
      - traefik.constraint-label=traefik-public
      - traefik.docker.network=traefik-proxy
      ## HTTP Routers
      - "traefik.http.routers.freshrss-rtr.entrypoints=https"
      - "traefik.http.routers.freshrss-rtr.rule=HostHeader(`freshrss.$SECONDDOMAINNAME`)"
      ## Middlewares
      - "traefik.http.routers.freshrss-rtr.middlewares=chain-basic-auth@file"
      ## HTTP Services
      - "traefik.http.routers.freshrss-rtr.service=freshrss-svc"
      - "traefik.http.services.freshrss-svc.loadbalancer.server.port=5800"
    environments: #Environmental values set for the applications
      PUID: $PUID
      PGID: $PGID
      TZ: $TZ
    volumes:
      - $DOCKERDIR/$APPLICATION:/config
    restart: unless-stopped #runtime policy

volumes: #volume mapping for shared folder/binds
  $volumename: #Name of volumes
    driver: local
    driver_opts:
      type: none
      device: /smb/$path #local SMB mount path
      o: bind

networks:
  traefik-proxy:
    external: true

##################################################
##################################################
